import{m as j,n as z,P as I,r as a,u as B,a as R,b as U,A as M,c as D,j as e,f as A,d as C,S as E,e as T,g as i,h as W,i as $,B as F,k as G,R as O,l as Z,C as H,W as q,o as J}from"./vendor.69b7f72f.js";const Y=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}};Y();const Q=n=>`https://gravatar.com/avatar/${j(n)}?s=400&d=robohash&r=x`,X=()=>z(" "),ee="0.1.0",te="blog_sol",se=[{name:"USER_SEED",type:"bytes",value:"[117, 115, 101, 114]"},{name:"POST_SEED",type:"bytes",value:"[112, 111, 115, 116]"}],oe=[{name:"initUser",accounts:[{name:"userAccount",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"name",type:"string"},{name:"avatar",type:"string"}]},{name:"createPost",accounts:[{name:"postAccount",isMut:!0,isSigner:!1},{name:"userAccount",isMut:!0,isSigner:!1},{name:"authority",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"title",type:"string"},{name:"content",type:"string"}]}],ne=[{name:"UserAccount",type:{kind:"struct",fields:[{name:"name",type:"string"},{name:"avatar",type:"string"},{name:"authority",type:"publicKey"},{name:"lastPostId",type:"u8"},{name:"postCount",type:"u8"}]}},{name:"PostAccount",type:{kind:"struct",fields:[{name:"id",type:"u8"},{name:"title",type:"string"},{name:"content",type:"string"},{name:"user",type:"publicKey"},{name:"authority",type:"publicKey"}]}}],re={address:"ARegp6JaVVGNVZR53ZavVvcZVGdyw21mVmJFgbaVnM3Z"};var _={version:ee,name:te,constants:se,instructions:oe,accounts:ne,metadata:re};const ae=new I(_.metadata.address),K=a.exports.createContext(),L=()=>{const n=a.exports.useContext(K);if(!n)throw new Error("Parent must be wrapped inside PostsProvider");return n},ce=({children:n})=>{const[r,s]=a.exports.useState(),[c,t]=a.exports.useState(!1),[o,d]=a.exports.useState(!1),[h,f]=a.exports.useState(!1),[m,x]=a.exports.useState(0),[v,k]=a.exports.useState([]),w=B(),{connection:N}=R(),{publicKey:u}=U(),l=a.exports.useMemo(()=>{if(w){const g=new M(N,w,M.defaultOptions());return new D(_,ae,g)}},[N,w]);a.exports.useEffect(()=>{(async()=>{if(l&&u)try{const[y]=await A([C.encode("user"),u.toBuffer()],l.programId);console.log("User Program Address:",y.toString());const p=await l.account.userAccount.fetch(y);if(p){t(!0),s(p),x(p.lastPostId);const S=await l.account.postAccount.all();k(S),console.log("User Data:",p),console.log("Post Accounts:",S)}else console.log("No User Found"),t(!0)}catch(y){console.error("Error while fetching user data:",y)}finally{}})()},[l,u,o]);const P=async()=>{if(l&&u)try{d(!0);const g=X(),y=Q(g),[p]=await A([C.encode("user"),u.toBuffer()],l.programId);await l.methods.initUser(g,y).accounts({userAccount:p,authority:u,systemProgram:E.programId}).rpc(),t(!0)}catch(g){console.log(g)}finally{t(!0)}},V=async(g,y)=>{if(l&&u){d(!0);try{const[p]=await A([C.encode("user"),u.toBuffer()],l.programId),[S]=A([C.encode("post"),u.toBuffer(),Uint8Array.from([m])],l.programId);await l.methods.createPost(g,y).accounts({postAccount:S,userAccount:p,authority:u,systemProgram:E.programId}).rpc(),f(!1)}catch(p){console.log(p)}finally{d(!1)}}};return e(K.Provider,{value:{user:r,initialized:c,initUser:P,showModal:h,setShowModal:f,createPost:V,posts:v,transactionPending:o},children:n})};async function ie(n,r){try{const s=await r.account.postAccount.fetch(new I(n)),c=s.user.toString();return c===E.programId.toString()?void 0:{id:n,title:s.title,content:s.content,userId:c}}catch(s){console.log(s.message)}}const le=new I(_.metadata.address);function de(n){return new D(_,le,n)}const ue=()=>{const{id:n}=T(),r=B(),{connection:s}=R(),[c,t]=a.exports.useState(),[o,d]=a.exports.useState();return a.exports.useEffect(()=>{try{c&&(async()=>{const f=de(c),m=await ie(n.toString(),f);d(m)})()}catch{}},[c]),a.exports.useEffect(()=>{if(r){const h=new M(s,r,{});t(h)}},[s,r]),i("article",{className:"hentry background-color",children:[e("h1",{className:"entry-title",children:o?.title}),e("div",{className:"entry-content",children:e("p",{children:o?.content})})]})},b=({children:n,loading:r=!1,disabled:s,className:c="",leftIcon:t,...o})=>(s=s||r,i("button",{disabled:s,className:`rounded-lg flex justify-center items-center py-2 px-4 border border-transparent text-sm font-medium text-white bg-gradient-to-r pink focus:outline-none shadow-md 
			${c} ${s?"opacity-60 cursor-not-allowed":"transform hover:-translate-y-px focus:shadow-sm focus:-translate-y-0"}
			`,...o,children:[!s&&!r&&t,s&&!r&&e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),r&&e("svg",{className:"animate-spin h-5 w-5 text-white mr-1",viewBox:"0 0 24 24",children:e("path",{fill:"currentColor",d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"})}),n]})),me=n=>{const{user:r}=L(),{onSubmit:s,postTitle:c,postContent:t,setPostContent:o,setPostTitle:d,formHeader:h,buttonText:f="Post"}=n,[m,x]=a.exports.useState(!1);return i("div",{className:"rounded-lg py-4 px-6 bg- flex flex-col ",children:[h,e("input",{value:c,onChange:v=>d(v.target.value),type:"text",placeholder:"Post title",className:"bg-white rounded-3xl h-10 px-4 black"}),e("textarea",{value:t,onChange:v=>o(v.target.value),name:"content",id:"content-area",rows:3,placeholder:"Describe your post...",className:"bg-white rounded-xl px-4 py-2 mt-3 black"}),e(b,{className:"mt-3",disabled:!r,loading:m,onClick:async()=>{x(!0),await s(),x(!1)},children:f})]})},pe=()=>{const n=W(),[r,s]=a.exports.useState(!1),{connected:c,select:t}=U(),[o,d]=a.exports.useState(""),[h,f]=a.exports.useState(""),{user:m,initialized:x,initUser:v,showModal:k,setShowModal:w,createPost:N,posts:u}=L(),l=()=>{s(!0),t($)};return a.exports.useEffect(()=>{m&&s(!0)},[m]),i("div",{className:"dashboard background-color overflow-auto h-screen",children:[e("header",{className:"fixed z-10 w-full h-14  shadow-md",children:i("div",{className:"flex justify-between items-center h-full container",children:[e("h2",{className:"text-2xl font-bold",children:e("div",{className:"bg-clip-text bg-gradient-to-br from-indigo-300 colorpink",children:"Solana Reddit"})}),c?i("div",{className:"flex items-center",children:[e("img",{src:m?.avatar,alt:"avatar",className:"w-8 h-8 rounded-full bg-gray-200 shadow ring-2 ring-indigo-400 ring-offset-2 ring-opacity-50"}),e("p",{className:"font-bold text-sm ml-2 capitalize",children:m?.name}),x?i("div",{className:"flex",children:[e(b,{className:"ml-3 mr-2",onClick:()=>{w(!0)},children:"Create Post"}),e(b,{className:"ml-3 mr-2",onClick:()=>{w(!0)},children:"Disconnect"})]}):e(b,{className:"ml-3 mr-2",onClick:()=>{v()},children:"Initialize User"})]}):e(b,{loading:r,className:"w-28",onClick:l,leftIcon:e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"}),children:"Connect"})]})}),i("main",{className:"dashboard-main pb-4 container flex relative",children:[i("div",{className:"pt-3",children:[e("h1",{className:"title",children:"-------SOLANA REDDIT------- "}),i("div",{className:"row",children:[e("article",{className:"best-post",children:e("div",{className:"best-post-image",style:{backgroundImage:'url("https://imgs.hipertextual.com/wp-content/uploads/2021/08/reddit-2.png")'}})}),e("div",{className:"all__posts",children:u.map(P=>e("article",{className:"post__card-2",onClick:()=>{n.push(`/read-post/${P.publicKey.toString()}`)},children:i("div",{className:"post__card_-2",children:[e("div",{className:"post__card__image-2",style:{backgroundImage:'url("https://media.wired.com/photos/5a55b7eb091d162e40e4b202/191:100/w_1280,c_limit/reddit-alien-red.jpg")'}}),e("div",{children:i("div",{className:"post__card_meta-2",children:[i("div",{className:"post__card_cat",children:[e("span",{className:"dot",children:" "}),P.account.title," "]}),e("p",{className:"post__card_alttitle-2",children:P.account.content})]})})]})},P.account.id))})]})]}),e("div",{className:`modal ${k&&"show-modal"}`,children:i("div",{className:"modal-content",children:[e("span",{className:"close-button",onClick:()=>w(!1),children:"\xD7"}),e(me,{postTitle:o,postContent:h,setPostTitle:d,setPostContent:f,onSubmit:()=>N(o,h)})]})})]})]})},he=()=>e(F,{children:i(G,{children:[e(O,{path:"/",exact:!0,children:e(pe,{})}),e(O,{path:"/read-post/:id",children:e(ue,{})})]})});const ge=()=>{const n="https://twilight-methodical-sky.solana-devnet.discover.quiknode.pro/7d464082b4e6eb653671abc14c117d05d0c6c47c/",r=a.exports.useMemo(()=>[new Z],[]);return e(H,{endpoint:n,children:e(q,{wallets:r,autoConnect:!0,children:e(ce,{children:e(he,{})})})})};J.render(e(ge,{}),document.getElementById("root"));
